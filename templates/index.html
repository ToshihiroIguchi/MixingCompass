<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ app_name }}</title>
    <link rel="stylesheet" href="/static/css/styles.css?v=2024092906">
</head>
<body>
    <header class="header">
        <div class="header-content">
            <div class="logo-section">
                <img src="/static/images/mc_logo.png" alt="MixingCompass Logo" class="logo">
                <h1>{{ app_name }}</h1>
            </div>
            <nav class="navigation">
                <button class="nav-btn active" data-section="hsp-experimental">HSP (Experimental)</button>
                <button class="nav-btn" data-section="hsp-calculation">HSP (Calculation)</button>
                <button class="nav-btn" data-section="solvent-search">Solvent Search</button>
                <a href="/data-list" class="nav-btn">Data List</a>
            </nav>
        </div>
    </header>

    <main class="main-content">
        <!-- HSP Experimental Section -->
        <section id="hsp-experimental" class="content-section active">
            <div class="split-layout">
                <div class="left-panel">
                    <div class="panel-header">
                        <h2>HSP Experimental Data</h2>
                        <button id="load-data-btn" class="btn btn-secondary">Load Data</button>
                    </div>
                    <div class="sample-info">
                        <label>Sample Name:</label>
                        <input type="text" id="sample-name" placeholder="Enter sample name" required>
                    </div>
                    <div id="solvent-table-container" class="data-table-container">
                        <!-- Solvent table will be dynamically generated -->
                    </div>
                    <div class="calculation-section">
                        <button id="calculate-btn" class="btn btn-primary">Analyze & Visualize</button>
                        <div class="calculation-status" id="calculation-status"></div>
                    </div>
                </div>
                <div class="right-panel">
                    <div class="results-section">
                        <div class="results-header">
                            <h3>HSP</h3>
                            <div class="hsp-values-inline">
                                <span class="hsp-value-inline">
                                    <label>&delta;D:</label>
                                    <span id="delta-d" class="value">-</span>
                                    <span class="unit">MPa<sup>0.5</sup></span>
                                </span>
                                <span class="hsp-value-inline">
                                    <label>&delta;P:</label>
                                    <span id="delta-p" class="value">-</span>
                                    <span class="unit">MPa<sup>0.5</sup></span>
                                </span>
                                <span class="hsp-value-inline">
                                    <label>&delta;H:</label>
                                    <span id="delta-h" class="value">-</span>
                                    <span class="unit">MPa<sup>0.5</sup></span>
                                </span>
                                <span class="hsp-value-inline">
                                    <label>Ra:</label>
                                    <span id="ra" class="value">-</span>
                                    <span class="unit">MPa<sup>0.5</sup></span>
                                </span>
                            </div>
                            <div class="result-actions">
                                <button id="details-info-btn" class="info-btn" title="View calculation details" style="display: none;">â“˜</button>
                                <button id="copy-hsp-btn" class="info-btn" title="Copy HSP data for Excel" style="display: none;">ðŸ“‹</button>
                            </div>
                        </div>
                    </div>
                    <div class="hansen-sphere" id="hansen-sphere-container">
                        <div class="viz-tabs">
                            <button class="viz-tab active" data-view="view-3d">3D View</button>
                            <button class="viz-tab" data-view="view-2d">2D Projections</button>
                        </div>
                        <div id="view-3d" class="view-panel active">
                            <div id="plotly-visualization" class="plotly-container">
                                <div class="visualization-placeholder">
                                    <p>Calculate HSP to display 3D Hansen sphere</p>
                                    <small>Interactive 3D visualization will appear after calculation</small>
                                </div>
                            </div>
                        </div>
                        <div id="view-2d" class="view-panel" style="display: none;">
                            <div class="grid-2d">
                                <div class="plot-item">
                                    <div id="plot-dd-dp" class="plot-2d"></div>
                                </div>
                                <div class="plot-item">
                                    <div id="plot-dd-dh" class="plot-2d"></div>
                                </div>
                                <div class="plot-item">
                                    <div id="plot-dp-dh" class="plot-2d"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="action-buttons">
                        <button id="save-result-btn" class="btn btn-secondary" disabled>Save Result</button>
                        <button id="export-result-btn" class="btn btn-secondary" disabled>Export Result</button>
                        <button id="export-graphs-btn" class="btn btn-primary" disabled>Export Graphs (ZIP)</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Calculation Details Modal -->
        <div id="calculation-details-modal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h4>Calculation Details</h4>
                    <button class="modal-close">&times;</button>
                </div>
                <div class="modal-body" id="modal-calculation-details">
                    <!-- Details will be populated here -->
                </div>
            </div>
        </div>

        <!-- Load Data Modal -->
        <div id="load-data-modal" class="modal" style="display: none;">
            <div class="modal-content modal-large">
                <div class="modal-header">
                    <h3>Load Experimental Result</h3>
                    <button class="modal-close">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="search-section">
                        <input type="text" id="result-search" class="search-input" placeholder="Search by sample name...">
                    </div>
                    <div id="results-list" class="results-list">
                        <!-- Results will be populated here -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="cancel-load-data" class="btn btn-secondary">Cancel</button>
                </div>
            </div>
        </div>

        <!-- HSP Calculation Section -->
        <section id="hsp-calculation" class="content-section">
            <h2>HSP Calculation</h2>
            <p>SMILES-based calculation functionality (To be implemented)</p>
        </section>

        <!-- Solvent Search Section -->
        <section id="solvent-search" class="content-section">
            <h2>Solvent Search</h2>
            <p>Solvent search functionality (To be implemented)</p>
        </section>

        <!-- Data List Section -->
        <section id="data-list" class="content-section">
            <h2>Data List</h2>
            <p>Data list management functionality (To be implemented)</p>
        </section>
    </main>

    <script src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>
    <script src="/static/js/utils.js"></script>
    <script src="/static/js/notification.js"></script>
    <script src="/static/js/storage.js"></script>
    <script src="/static/js/main.js"></script>
    <script src="/static/js/solvent_set_manager.js"></script>
    <script src="/static/js/experimental_results_manager.js"></script>
    <script src="/static/js/hsp_experimental.js"></script>
</body>
</html>