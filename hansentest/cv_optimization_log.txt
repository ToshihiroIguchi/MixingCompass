
================================================================================
HANSEN SOLUBILITY PARAMETER DETERMINATION
Using Cross-Validation to Optimize size_factor
================================================================================

Dataset: hansentest.csv
  Total solvents: 28
  Good (y=1.0):   11
  Partial (y=0.5): 5
  Poor (y=0.0):   12
================================================================================
GRID SEARCH: Optimizing size_factor using Cross-Validation
================================================================================
Dataset: 28 solvents
CV Method: Leave-One-Out Cross-Validation (LOOCV)
Size factors to test: 9
Optimization iterations per fold: 3000
================================================================================

[1/9] Testing size_factor = 0.0
--------------------------------------------------------------------------------
  Fold 10/28 complete
  Fold 20/28 complete
  Results:
    Mean Test Loss:  0.000433 Å} 0.000995
    Mean Train Loss: 0.000208 Å} 0.000038
    Overfitting Gap: 0.000225
    Mean Ra:         15.75 Å} 0.14

[2/9] Testing size_factor = 0.0001
--------------------------------------------------------------------------------
  Fold 10/28 complete
  Fold 20/28 complete
  Results:
    Mean Test Loss:  0.006298 Å} 0.015252
    Mean Train Loss: 0.003495 Å} 0.000528
    Overfitting Gap: 0.002803
    Mean Ra:         7.63 Å} 0.08

[3/9] Testing size_factor = 0.0003
--------------------------------------------------------------------------------
  Fold 10/28 complete
  Fold 20/28 complete
  Results:
    Mean Test Loss:  0.012044 Å} 0.026610
    Mean Train Loss: 0.006065 Å} 0.000763
    Overfitting Gap: 0.005979
    Mean Ra:         6.96 Å} 0.09

[4/9] Testing size_factor = 0.0005
--------------------------------------------------------------------------------
  Fold 10/28 complete
  Fold 20/28 complete
  Results:
    Mean Test Loss:  0.015960 Å} 0.035192
    Mean Train Loss: 0.008005 Å} 0.000871
    Overfitting Gap: 0.007955
    Mean Ra:         6.65 Å} 0.09

[5/9] Testing size_factor = 0.0007
--------------------------------------------------------------------------------
  Fold 10/28 complete
  Fold 20/28 complete
  Results:
    Mean Test Loss:  0.019144 Å} 0.042527
    Mean Train Loss: 0.009738 Å} 0.000942
    Overfitting Gap: 0.009406
    Mean Ra:         6.43 Å} 0.09

[6/9] Testing size_factor = 0.001
--------------------------------------------------------------------------------
  Fold 10/28 complete
  Fold 20/28 complete
  Results:
    Mean Test Loss:  0.023297 Å} 0.052838
    Mean Train Loss: 0.012193 Å} 0.001024
    Overfitting Gap: 0.011104
    Mean Ra:         6.20 Å} 0.08

[7/9] Testing size_factor = 0.0015
--------------------------------------------------------------------------------
  Fold 10/28 complete
  Fold 20/28 complete
  Results:
    Mean Test Loss:  0.029190 Å} 0.068123
    Mean Train Loss: 0.015924 Å} 0.001125
    Overfitting Gap: 0.013265
    Mean Ra:         5.93 Å} 0.08

[8/9] Testing size_factor = 0.002
--------------------------------------------------------------------------------
  Fold 10/28 complete
  Fold 20/28 complete
  Results:
    Mean Test Loss:  0.034057 Å} 0.080185
    Mean Train Loss: 0.019379 Å} 0.001196
    Overfitting Gap: 0.014677
    Mean Ra:         5.74 Å} 0.07

[9/9] Testing size_factor = 0.003
--------------------------------------------------------------------------------
  Fold 10/28 complete
  Fold 20/28 complete
  Results:
    Mean Test Loss:  0.043130 Å} 0.102444
    Mean Train Loss: 0.025786 Å} 0.001323
    Overfitting Gap: 0.017344
    Mean Ra:         5.47 Å} 0.07

================================================================================
MODEL SELECTION
================================================================================

Candidate size_factors by criterion:
  Best by Test Loss:       0.0
  Best by Balanced:        0.0

--------------------------------------------------------------------------------
size_factor  Test Loss    Train Loss   Gap          Ra        
--------------------------------------------------------------------------------
0.0000       0.000433     0.000208     0.000225     15.75      Å© Best (test loss)
0.0001       0.006298     0.003495     0.002803     7.63      
0.0003       0.012044     0.006065     0.005979     6.96      
0.0005       0.015960     0.008005     0.007955     6.65      
0.0007       0.019144     0.009738     0.009406     6.43      
0.0010       0.023297     0.012193     0.011104     6.20      
0.0015       0.029190     0.015924     0.013265     5.93      
0.0020       0.034057     0.019379     0.014677     5.74      
0.0030       0.043130     0.025786     0.017344     5.47      
--------------------------------------------------------------------------------

Final Selection: size_factor = 0.0
  Rationale: Balanced criterion minimizes both test loss and overfitting

================================================================================
TRAINING FINAL MODEL
================================================================================
Using all 28 solvents
Optimal size_factor: 0.0
Optimization iterations: 5000
--------------------------------------------------------------------------------

Final Hansen Solubility Parameters:
  É¬D (Dispersion):       30.00 MPa^0.5
  É¬P (Polar):            10.77 MPa^0.5
  É¬H (Hydrogen bonding): 12.73 MPa^0.5
  Ra (Interaction radius): 15.78 MPa^0.5

Final Model Performance:
  Loss (ContinuousHSPLoss): 0.000210
  Optimization Error:        0.000018
Traceback (most recent call last):
  File "C:\Users\toshi\Documents\python\MixingCompass\hansentest\optimize_size_factor.py", line 386, in <module>
    results = main()
  File "C:\Users\toshi\Documents\python\MixingCompass\hansentest\optimize_size_factor.py", line 334, in main
    final_hsp, final_est, final_metrics = train_final_model(
                                          ~~~~~~~~~~~~~~~~~^
        X, y, final_size_factor, de_maxiter=5000
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\toshi\Documents\python\MixingCompass\hansentest\optimize_size_factor.py", line 181, in train_final_model
    dist = hansen_distance(X[i], center)
  File "C:\Users\toshi\Documents\python\MixingCompass\hansentest\optimize_size_factor.py", line 14, in hansen_distance
    return np.sqrt(np.sum((X - center)**2, axis=1))
                   ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\toshi\Documents\python\MixingCompass\venv\Lib\site-packages\numpy\_core\fromnumeric.py", line 2466, in sum
    return _wrapreduction(
        a, np.add, 'sum', axis, dtype, out,
        keepdims=keepdims, initial=initial, where=where
    )
  File "C:\Users\toshi\Documents\python\MixingCompass\venv\Lib\site-packages\numpy\_core\fromnumeric.py", line 86, in _wrapreduction
    return ufunc.reduce(obj, axis, dtype, out, **passkwargs)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
numpy.exceptions.AxisError: axis 1 is out of bounds for array of dimension 1
